# GO terms usando la interseccion de kopt y hpb: vademás de los genes
# de la intersección, necesitamos que tengan el mismo sentido en logFC
intersect.pos <- intersect(rownames(toptableIQR.kopt.sig.pos), rownames(toptableIQR.hpb.sig.pos)) #45
intersect.neg <- intersect(rownames(toptableIQR.kopt.sig.neg), rownames(toptableIQR.hpb.sig.neg)) #176
# Esto significa que de los 714 DEGs de la intersección, sólo comparten el sentido de logFC 221 genes.
GO.intersect.pos <- GO_analysis(intersect.pos, universe, "BP")
GO.intersect.neg <- GO_analysis(intersect.neg, universe, "BP")
jpeg("figuras/GOBP.intersect.pos.jpg", width = 900, height = 600)
dotplot(GO.intersect.pos, showCategory = 10, font.size = 10, title = "GO:BP Intersect Upregulation KOPT-K1, HPB-ALL")
dev.off()
jpeg("figuras/GOBP.intersect.neg.jpg", width = 900, height = 600)
dotplot(GO.intersect.neg, showCategory = 10, font.size = 10, title = "GO:BP Intersect Downregulation KOPT-K1, HPB-ALL")
dev.off()
save.image("~/Desktop/Omics/microarrays/trabajo-microarray/trabajo_microarray.RData")
setwd("/home/guille/Desktop/Omics/microarrays/trabajo-microarray/")
library(affy)
library(limma)
library(genefilter)
library(ArrayTools)
library(Biobase)
library(GEOquery)
library(annotate)
library(hgu133plus2.db)
library(topGO)
library(clusterProfiler)
library(ggplot2)
library(stringr)
write.table(exprs(eset), file = "/home/guille/Desktop/Omics/microarrays/trabajo-microarray/samples_clustering/ematrix.txt")
test <- read.table("samples_clustering/ematrix.txt")
View(test)
View(as.data.frame(kegg.cov))
KEGG_analysis <- function(genes){
enrichKEGG(genes,
organism = "hsa",
keyType = "ncbi-geneid",
pvalueCutoff = 0.05,
pAdjustMethod = "BH",
universe = unique(toptable.cov.gsea$ENTREZ),
minGSSize = 10,
maxGSSize = 500,
qvalueCutoff = 0.2,
use_internal_data = FALSE) # usa la db online más reciente
}
kegg.cov <- KEGG_analysis(toptableIQR.cov$ENTREZ)
View(as.data.frame(kegg.cov))
pathview_vector.cov <- toptable.cov.gsea[, "logFC"]
names(pathview_vector.cov) <- toptable.cov.gsea[, "ENTREZ"]
setwd("/home/guille/Desktop/Omics/microarrays/trabajo-microarray/kegg/")
sigpaths <- as.data.frame(kegg.cov)[, "ID"]
### Establecer directorio de trabajo y cargar librerias
setwd("/home/guille/Desktop/Omics/microarrays/trabajo-microarray/")
library(affy)
library(limma)
library(genefilter)
library(ArrayTools)
library(Biobase)
library(GEOquery)
library(annotate)
library(hgu133plus2.db)
library(topGO)
library(clusterProfiler)
library(ggplot2)
library(stringr)
library(pathview)
#############KEGG pathways##############
KEGG_analysis <- function(genes){
enrichKEGG(genes,
organism = "hsa",
keyType = "ncbi-geneid",
pvalueCutoff = 0.05,
pAdjustMethod = "BH",
universe = unique(toptable.cov.gsea$ENTREZ),
minGSSize = 10,
maxGSSize = 500,
qvalueCutoff = 0.2,
use_internal_data = FALSE) # usa la db online más reciente
}
kegg.cov <- KEGG_analysis(toptableIQR.cov$ENTREZ)
View(as.data.frame(kegg.cov))
pathview_vector.cov <- toptable.cov.gsea[, "logFC"]
names(pathview_vector.cov) <- toptable.cov.gsea[, "ENTREZ"]
setwd("/home/guille/Desktop/Omics/microarrays/trabajo-microarray/kegg/")
sigpaths <- as.data.frame(kegg.cov)[, "ID"]
toptable.cov.gsea <- anno(toptable.cov.gsea)
fit2 <- lmFit(eset, design.cov)
fit2 <- eBayes(fit2)
toptable.cov.gsea <-topTable(fit2, coef="treat.covSAHM1", number=dim(exprs(eset))[1], adjust.method="BH", sort.by="p")
rm(fit2)
load("~/Desktop/Omics/microarrays/trabajo-microarray/trabajo_microarray.RData")
View(as.data.frame(kegg.cov))
library(ReactomePA)
reactome.cov <- enrichPathway(toptableIQR.cov$ENTREZ,
organism = "human",
keyType = "ncbi-geneid",
pvalueCutoff = 0.05,
universe = unique(toptable.cov.gsea$ENTREZ),
minGSSize = 10,
maxGSSize = 500,
qvalueCutoff = 0.2,
readable = T)
reactome.cov <- enrichPathway(toptableIQR.cov$ENTREZ,
organism = "human",
pvalueCutoff = 0.05,
universe = unique(toptable.cov.gsea$ENTREZ),
minGSSize = 10,
maxGSSize = 500,
pAdjustMethod = "BH",
qvalueCutoff = 0.2,
readable = T)
View(as.data.frame(reactome.cov))
manpaths <- c("hsa04151", #PI3K-AKT
"hsa04010", #MAPK
"hsa05230", #Central metabolism in cancer
"hsa04612", #Antigen processing and presentation
"hsa05200", #Pathways in cancer
"hsa05235") #PD-L1 expression and PD-1 checkpoint pathway in cancer
setwd("/home/guille/Desktop/Omics/microarrays/trabajo-microarray/kegg/seleccionadas_manualmente/")
for(i in manpaths){
pathview(pathview_vector.cov,
pathway.id = i,
species = "hsa",
gene.idtype = "entrez",
kegg.dir = "/home/guille/Desktop/Omics/microarrays/trabajo-microarray/kegg/kegg_data/",
low = "green", mid = "white", high = "red", na.col = "grey")
}
manpaths <- c("hsa04151", #PI3K-AKT
"hsa04010", #MAPK
"hsa05230", #Central metabolism in cancer
"hsa04612", #Antigen processing and presentation
"hsa05200", #Pathways in cancer
"hsa05235", #PD-L1 expression and PD-1 checkpoint pathway in cancer
"hsa04110", #Cell cycle
"hsa04210") #Apoptosis
setwd("/home/guille/Desktop/Omics/microarrays/trabajo-microarray/kegg/seleccionadas_manualmente/")
for(i in manpaths){
pathview(pathview_vector.cov,
pathway.id = i,
species = "hsa",
gene.idtype = "entrez",
kegg.dir = "/home/guille/Desktop/Omics/microarrays/trabajo-microarray/kegg/kegg_data/",
low = "green", mid = "white", high = "red", na.col = "grey")
}
View(toptable.cov.gsea)
toptable.cov.gsea$adj.P.Val<0.05
for(i in toptable.cov.gsea){
if(toptable.cov.gsea$adj.P.Val<0.05){
toptable.cov.gsea$sig <- 1
}
else{
toptable.cov.gsea$sig <- -1
}
}
for(i in toptable.cov.gsea){
print(i)
}
length(toptable.cov.gsea)
toptable.cov.gsea$adj.P.Val[3]
View(toptable.cov.gsea)
for(i in length(toptable.cov.gsea$adj.P.Val)){
if(toptable.cov.gsea$adj.P.Val[i] < 0.05){
toptable.cov.gsea$sig[i] <- 1
}
else{
toptable.cov.gsea$sig <- -1
}
}
for(i in 1:length(toptable.cov.gsea$adj.P.Val)){
if(toptable.cov.gsea$adj.P.Val[i] < 0.05){
toptable.cov.gsea$sig[i] <- 1
}
else{
toptable.cov.gsea$sig <- -1
}
}
1:length(toptable.cov.gsea$adj.P.Val)
toptable.cov.gsea$sig <- NA
for(i in 1:length(toptable.cov.gsea$adj.P.Val)){
if(toptable.cov.gsea$adj.P.Val[i] < 0.05){
toptable.cov.gsea$sig[i] <- 1
}
else{
toptable.cov.gsea$sig <- -1
}
}
toptable.cov.gsea$adj.P.Val[5]
toptable.cov.gsea$adj.P.Val[5]<0.05
toptable.cov.gsea$sig <- NULL
for(i in 1:length(toptable.cov.gsea$adj.P.Val)){
if(toptable.cov.gsea$adj.P.Val[i] < 0.05){
toptable.cov.gsea$sig[i] <- 1
}
else{
toptable.cov.gsea$sig[i] <- -1
}
}
pathview_matrix.cov <- matrix(toptable.cov.gsea[, "ENTREZ", "logFC", "sig"], nrow=length(toptable.cov.gsea), ncol = 3)
toptable.cov.gsea[, "ENTREZ", "logFC", "sig"]
pathview_matrix.cov <- matrix(toptable.cov.gsea[, c("ENTREZ", "logFC", "sig")], nrow=length(toptable.cov.gsea), ncol = 3)
pathview_matrix.cov <- matrix(toptable.cov.gsea[, c("ENTREZ", "logFC", "sig")], nrow=length(toptable.cov.gsea), ncol = 3)
View(pathview_matrix.cov)
pathview_matrix.cov <- as.matrix(toptable.cov.gsea[, c("ENTREZ", "logFC", "sig")])
View(pathview_matrix.cov)
setwd("/home/guille/Desktop/Omics/microarrays/trabajo-microarray/test/")
pathview(pathview_matrix.cov,
pathway.id = "hsa04218",
species = "hsa",
gene.idtype = "entrez",
kegg.dir = "/home/guille/Desktop/Omics/microarrays/trabajo-microarray/kegg/kegg_data/",
low = "green", mid = "white", high = "red", na.col = "grey",
multi.state = T,
same.layer = T)
pathview(pathview_matrix.cov,
pathway.id = "hsa04218",
species = "hsa",
gene.idtype = "entrez",
kegg.dir = "/home/guille/Desktop/Omics/microarrays/trabajo-microarray/kegg/kegg_data/",
low = "green", mid = "white", high = "red", na.col = "grey",
multi.state = T,
same.layer = T,
match.data = F)
View(pathview_matrix.cov)
pathview(pathview_matrix.cov,
pathway.id = "hsa04218",
species = "hsa",
gene.idtype = "entrez",
kegg.dir = "/home/guille/Desktop/Omics/microarrays/trabajo-microarray/kegg/kegg_data/",
low = "green", mid = "white", high = "red", na.col = "grey",
keys.align = "y",
multi.state = F,
same.layer = T,
match.data = F)
rownames(pathview_matrix.cov) <- pathview_matrix.cov[,1]
View(pathview_matrix.cov)
pathview_df.cov <- toptable.cov.gsea[, c("ENTREZ", "logFC", "sig")]
View(pathview_df.cov)
pathview_df.cov <- pathview_df.cov[!is.na(pathview_df.cov$ENTREZ)]
pathview_df.cov <- pathview_df.cov[!is.na(pathview_df.cov$ENTREZ),]
pathview_df.cov <- pathview_df.cov[!duplicated(pathview_df.cov$ENTREZ)]
pathview_df.cov <- pathview_df.cov[!duplicated(pathview_df.cov$ENTREZ),]
pathview_matrix.cov <- as.matrix(pathview_df.cov)
View(pathview_matrix.cov)
rownames(pathview_matrix.cov) <- pathview_matrix.cov[,1]
pathview_matrix.cov[,1] <- NULL
pathview_matrix.cov[,-1]
pathview_matrix.cov <- pathview_matrix.cov[,-1]
setwd("/home/guille/Desktop/Omics/microarrays/trabajo-microarray/test/")
pathview(pathview_matrix.cov,
pathway.id = "hsa04218",
species = "hsa",
gene.idtype = "entrez",
kegg.dir = "/home/guille/Desktop/Omics/microarrays/trabajo-microarray/kegg/kegg_data/",
low = "green", mid = "white", high = "red", na.col = "grey",
keys.align = "y",
multi.state = T,
same.layer = T,
match.data = T)
pathview(pathview_matrix.cov,
pathway.id = "hsa04218",
species = "hsa",
gene.idtype = "entrez",
kegg.dir = "/home/guille/Desktop/Omics/microarrays/trabajo-microarray/kegg/kegg_data/",
low = "green", mid = "white", high = "red", na.col = "grey")
pathview(pathview_matrix.cov[,1],
pathway.id = "hsa04218",
species = "hsa",
gene.idtype = "entrez",
kegg.dir = "/home/guille/Desktop/Omics/microarrays/trabajo-microarray/kegg/kegg_data/",
low = "green", mid = "white", high = "red", na.col = "grey")
test.matrix <- pathview_matrix.cov[,-2]
test.matrix
pathview(test.matrix,
pathway.id = "hsa04218",
species = "hsa",
gene.idtype = "entrez",
kegg.dir = "/home/guille/Desktop/Omics/microarrays/trabajo-microarray/kegg/kegg_data/",
low = "green", mid = "white", high = "red", na.col = "grey")
View(pathview_matrix.cov)
for(i in 1:length(toptable.cov.gsea$adj.P.Val)){
if(toptable.cov.gsea$adj.P.Val[i] < 0.05){
toptable.cov.gsea$sig[i] <- max(toptable.cov.gsea$adj.P.Val)
}
else{
toptable.cov.gsea$sig[i] <- min(max(toptable.cov.gsea$adj.P.Val))
}
}
for(i in 1:length(toptable.cov.gsea$adj.P.Val)){
if(toptable.cov.gsea$adj.P.Val[i] < 0.05){
toptable.cov.gsea$sig[i] <- max(toptable.cov.gsea$adj.P.Val)
}
else{
toptable.cov.gsea$sig[i] <- min(toptable.cov.gsea$adj.P.Val)
}
}
pathview_df.cov <- toptable.cov.gsea[, c("ENTREZ", "logFC", "sig")]
pathview_df.cov <- pathview_df.cov[!is.na(pathview_df.cov$ENTREZ),]
pathview_df.cov <- pathview_df.cov[!duplicated(pathview_df.cov$ENTREZ),]
pathview_matrix.cov <- as.matrix(pathview_df.cov)
rownames(pathview_matrix.cov) <- pathview_matrix.cov[,1]
pathview_matrix.cov <- pathview_matrix.cov[,-1]
View(pathview_matrix.cov)
for(i in 1:length(toptable.cov.gsea$adj.P.Val)){
if(toptable.cov.gsea$adj.P.Val[i] < 0.05){
toptable.cov.gsea$sig[i] <- max(toptable.cov.gsea$logFC)
}
else{
toptable.cov.gsea$sig[i] <- min(toptable.cov.gsea$logFC)
}
}
pathview_df.cov <- toptable.cov.gsea[, c("ENTREZ", "logFC", "sig")]
pathview_df.cov <- pathview_df.cov[!is.na(pathview_df.cov$ENTREZ),]
pathview_df.cov <- pathview_df.cov[!duplicated(pathview_df.cov$ENTREZ),]
pathview_matrix.cov <- as.matrix(pathview_df.cov)
rownames(pathview_matrix.cov) <- pathview_matrix.cov[,1]
pathview_matrix.cov <- pathview_matrix.cov[,-1]
setwd("/home/guille/Desktop/Omics/microarrays/trabajo-microarray/test/")
pathview(test.matrix,
pathway.id = "hsa04218",
species = "hsa",
gene.idtype = "entrez",
kegg.dir = "/home/guille/Desktop/Omics/microarrays/trabajo-microarray/kegg/kegg_data/",
low = "green", mid = "white", high = "red", na.col = "grey")
View(pathview_df.cov)
pathview_matrix.cov[5290]
pathview_matrix.cov[3725]
pathview_matrix.cov[rowname==3725,]
pathview_matrix.cov[rownames(pathview_matrix.cov)==3725,]
pathview_matrix.cov[rownames(pathview_matrix.cov)==5290,]
colnames(pathview_matrix.cov) <- c("exp1", "exp2")
pathview(test.matrix,
pathway.id = "hsa04218",
species = "hsa",
gene.idtype = "entrez",
kegg.dir = "/home/guille/Desktop/Omics/microarrays/trabajo-microarray/kegg/kegg_data/",
low = "green", mid = "white", high = "red", na.col = "grey")
getwd()
pathview(test.matrix,
pathway.id = "hsa04218",
species = "hsa",
gene.idtype = "entrez",
kegg.dir = "/home/guille/Desktop/Omics/microarrays/trabajo-microarray/kegg/kegg_data/",
low = "green", mid = "white", high = "red", na.col = "grey")
pathview_matrix.cov[,1:2]
pathview_df.cov <- toptable.cov.gsea[, c("ENTREZ", "logFC", "sig")]
pathview_df.cov <- pathview_df.cov[!is.na(pathview_df.cov$ENTREZ),]
pathview_df.cov <- pathview_df.cov[!duplicated(pathview_df.cov$ENTREZ),]
pathview_matrix.cov <- as.matrix(pathview_df.cov)
rownames(pathview_matrix.cov) <- pathview_matrix.cov[,1]
pathview_matrix.cov <- numeric(pathview_matrix.cov)
colnames(pathview_matrix.cov) <- c("exp1", "exp2")
pathview_matrix.cov <- pathview_matrix.cov[,-1]
pathview_matrix.cov[,1:2]
View(pathview_matrix.cov)
pathview_matrix.cov <- as.numeric(pathview_matrix.cov)
pathview_df.cov <- toptable.cov.gsea[, c("ENTREZ", "logFC", "sig")]
pathview_df.cov <- pathview_df.cov[!is.na(pathview_df.cov$ENTREZ),]
pathview_df.cov <- pathview_df.cov[!duplicated(pathview_df.cov$ENTREZ),]
pathview_matrix.cov <- as.matrix(pathview_df.cov)
rownames(pathview_matrix.cov) <- pathview_matrix.cov[,1]
pathview_matrix.cov[,1:2] <- as.numeric(pathview_matrix.cov[,1:2])
colnames(pathview_matrix.cov) <- c("exp1", "exp2")
pathview_matrix.cov <- pathview_matrix.cov[,-1]
pathview_matrix.cov[,1] <- as.numeric(pathview_matrix.cov[,1])
pathview_matrix.cov <- sapply(pathview_matrix.cov, as.numeric)
pathview_df.cov <- toptable.cov.gsea[, c("ENTREZ", "logFC", "sig")]
pathview_df.cov <- pathview_df.cov[!is.na(pathview_df.cov$ENTREZ),]
pathview_df.cov <- pathview_df.cov[!duplicated(pathview_df.cov$ENTREZ),]
pathview_matrix.cov <- as.matrix(pathview_df.cov)
rownames(pathview_matrix.cov) <- pathview_matrix.cov[,1]
colnames(pathview_matrix.cov) <- c("exp1", "exp2")
pathview_matrix.cov <- pathview_matrix.cov[,-1]
pathview_matrix.cov <- apply(pathview_matrix.cov, 2, as.numeric)
pathview(gene.data = pathview_matrix.cov[,1:2],
pathway.id = "hsa04218",
species = "hsa",
gene.idtype = "entrez",
kegg.dir = "/home/guille/Desktop/Omics/microarrays/trabajo-microarray/kegg/kegg_data/",
low = "green", mid = "white", high = "red", na.col = "grey",
multi.state = T, same.layer = T)
pathview(gene.data = pathview_matrix.cov[,1:2],
pathway.id = "hsa04218",
species = "hsa",
gene.idtype = "entrez",
kegg.dir = "/home/guille/Desktop/Omics/microarrays/trabajo-microarray/kegg/kegg_data/",
low = "green", mid = "white", high = "red", na.col = "grey")
pathview_df.cov <- toptable.cov.gsea[, c("ENTREZ", "logFC", "sig")]
pathview_df.cov <- pathview_df.cov[!is.na(pathview_df.cov$ENTREZ),]
pathview_df.cov <- pathview_df.cov[!duplicated(pathview_df.cov$ENTREZ),]
pathview_matrix.cov <- as.matrix(pathview_df.cov)
pathview_matrix.cov <- pathview_matrix.cov[,-1]
pathview_matrix.cov <- apply(pathview_matrix.cov, 2, as.numeric)
row.names(pathview_matrix.cov) <- pathview_df.cov$ENTREZ
pathview(gene.data = pathview_matrix.cov,
pathway.id = "hsa04218",
species = "hsa",
gene.idtype = "entrez",
kegg.dir = "/home/guille/Desktop/Omics/microarrays/trabajo-microarray/kegg/kegg_data/",
low = "green", mid = "white", high = "red", na.col = "grey",
multi.state = T, same.layer = T)
pathview_vector.test <- toptableIQR.cov.sig[, "logFC"]
names(pathview_vector.test) <- toptableIQR.cov.sig[, "ENTREZ"]
pathview(gene.data = pathview_vector.test,
pathway.id = "hsa04218",
species = "hsa",
gene.idtype = "entrez",
kegg.dir = "/home/guille/Desktop/Omics/microarrays/trabajo-microarray/kegg/kegg_data/",
low = "green", mid = "white", high = "red", na.col = "grey")
pathview(gene.data = pathview_matrix.cov,
cpd.data = pathview_vector.test,
pathway.id = "hsa04218",
species = "hsa",
gene.idtype = "entrez",
kegg.dir = "/home/guille/Desktop/Omics/microarrays/trabajo-microarray/kegg/kegg_data/",
low = "green", mid = "white", high = "red", na.col = "grey",
multi.state = T, same.layer = T)
View(toptableIQR.cov.sig)
toptableIQR.cov.sig <- toptableIQR.cov[toptableIQR.cov$adj.P.Val<=0.05,]
View(toptableIQR.cov.sig)
table(pathview_df.cov$sig)
table(toptable.cov.gsea$sig)
table(sign(toptable.cov.gsea$logFC))
length(toptable.cov.gsea[toptable.cov.gsea$adj.P.Val<0.05,])
length(toptable.cov.gsea[toptable.cov.gsea$adj.P.Val<0.05])
length(toptable.cov.gsea$adj.P.Val<0.05)
nrow(toptable.cov.gsea[toptable.cov.gsea$adj.P.Val<0.05, ]
nrow(toptable.cov.gsea[toptable.cov.gsea$adj.P.Val<0.05, ]
)
nrow(toptable.cov.gsea[toptable.cov.gsea$adj.P.Val<0.05, ])
table(toptable.cov.gsea$sig)
"5290" in entrez_ids.cov
"5290" %in% entrez_ids.cov
"5290" %in% pathview_vector.test
"5290" %in% names(pathview_vector.test)
nrow(toptable.cov.gsea[toptable.cov.gsea$adj.P.Val<0.05, ])
pathview_vector.test
5887 %in% pathview_vector.test
5887 %in% names(pathview_vector.test)
5290 %in% names(pathview_vector.test)
pathview(gene.data = pathview_vector.test,
pathway.id = "hsa04218",
species = "hsa",
gene.idtype = "entrez",
kegg.dir = "/home/guille/Desktop/Omics/microarrays/trabajo-microarray/kegg/kegg_data/",
low = "green", mid = "white", high = "red", na.col = "grey")
5291 %in% names(pathview_vector.test)
5293 %in% names(pathview_vector.test)
5295 %in% names(pathview_vector.test)
5296 %in% names(pathview_vector.test)
8503 %in% names(pathview_vector.test)
View(pathview_matrix.cov)
rownames(pathview_matrix.cov==7157)
rownames(pathview_matrix.cov)==7157
which(rownames(pathview_matrix.cov)==7157)
pathview_matrix.cov[1351]
View(toptable.cov.gsea)
pathview(gene.data = pathview_matrix.cov[,1],
pathway.id = "hsa04218",
species = "hsa",
gene.idtype = "entrez",
kegg.dir = "/home/guille/Desktop/Omics/microarrays/trabajo-microarray/kegg/kegg_data/",
low = "green", mid = "white", high = "red", na.col = "grey")
for(i in 1:length(toptable.cov.gsea$adj.P.Val)){
if(toptable.cov.gsea$adj.P.Val[i] < 0.05){
toptable.cov.gsea$sig[i] <- max(toptable.cov.gsea$logFC)
}
else{
toptable.cov.gsea$sig[i] <- 0)
}
}
pathview_df.cov <- toptable.cov.gsea[, c("ENTREZ", "logFC", "sig")]
pathview_df.cov <- pathview_df.cov[!is.na(pathview_df.cov$ENTREZ),]
pathview_df.cov <- pathview_df.cov[!duplicated(pathview_df.cov$ENTREZ),]
pathview_matrix.cov <- as.matrix(pathview_df.cov)
pathview_matrix.cov <- pathview_matrix.cov[,-1]
pathview_matrix.cov <- apply(pathview_matrix.cov, 2, as.numeric)
row.names(pathview_matrix.cov) <- pathview_df.cov$ENTREZ
pathview(gene.data = pathview_matrix.cov,
cpd.data = pathview_vector.test,
pathway.id = "hsa04218",
species = "hsa",
gene.idtype = "entrez",
kegg.dir = "/home/guille/Desktop/Omics/microarrays/trabajo-microarray/kegg/kegg_data/",
low = "green", mid = "white", high = "red", na.col = "grey",
multi.state = T, same.layer = T)
for(i in 1:length(toptable.cov.gsea$adj.P.Val)){
if(toptable.cov.gsea$adj.P.Val[i] < 0.05){
toptable.cov.gsea$sig[i] <- max(toptable.cov.gsea$logFC)
}
else{
toptable.cov.gsea$sig[i] <- 0
}
}
pathview_df.cov <- toptable.cov.gsea[, c("ENTREZ", "logFC", "sig")]
pathview_df.cov <- pathview_df.cov[!is.na(pathview_df.cov$ENTREZ),]
pathview_df.cov <- pathview_df.cov[!duplicated(pathview_df.cov$ENTREZ),]
pathview_matrix.cov <- as.matrix(pathview_df.cov)
pathview_matrix.cov <- pathview_matrix.cov[,-1]
pathview_matrix.cov <- apply(pathview_matrix.cov, 2, as.numeric)
row.names(pathview_matrix.cov) <- pathview_df.cov$ENTREZ
test.matrix <- pathview_matrix.cov[,-2]
setwd("/home/guille/Desktop/Omics/microarrays/trabajo-microarray/test/")
pathview(gene.data = pathview_matrix.cov,
cpd.data = pathview_vector.test,
pathway.id = "hsa04218",
species = "hsa",
gene.idtype = "entrez",
kegg.dir = "/home/guille/Desktop/Omics/microarrays/trabajo-microarray/kegg/kegg_data/",
low = "green", mid = "white", high = "red", na.col = "grey",
multi.state = T, same.layer = T)
which(rownames(pathview_matrix.cov)==4790)
pathview_matrix.cov(which(rownames(pathview_matrix.cov)==4790))
pathview_matrix.cov[which(rownames(pathview_matrix.cov)==4790)]
save.image("~/Desktop/Omics/microarrays/trabajo-microarray/trabajo_microarray.RData")
